/// 한국 공휴일 데이터 (2024~2030)
class KoreanHolidays {
  KoreanHolidays._();

  /// 양력 고정 공휴일
  static const _fixedHolidays = {
    // (월, 일) → 명칭
    (1, 1): '신정',
    (3, 1): '삼일절',
    (5, 5): '어린이날',
    (6, 6): '현충일',
    (8, 15): '광복절',
    (10, 3): '개천절',
    (10, 9): '한글날',
    (12, 25): '크리스마스',
  };

  /// 음력 기반 공휴일 (설날·추석 연휴) — 연도별 양력 날짜
  static const Map<int, List<(int, int, String)>> _lunarHolidays = {
    2024: [
      (2, 9, '설날 연휴'), (2, 10, '설날'), (2, 11, '설날 연휴'), (2, 12, '대체공휴일'),
      (4, 10, '총선'),
      (5, 15, '부처님오신날'),
      (9, 16, '추석 연휴'), (9, 17, '추석'), (9, 18, '추석 연휴'),
    ],
    2025: [
      (1, 28, '설날 연휴'), (1, 29, '설날'), (1, 30, '설날 연휴'),
      (5, 5, '부처님오신날'),
      (10, 5, '추석 연휴'), (10, 6, '추석'), (10, 7, '추석 연휴'), (10, 8, '대체공휴일'),
    ],
    2026: [
      (2, 16, '설날 연휴'), (2, 17, '설날'), (2, 18, '설날 연휴'),
      (5, 24, '부처님오신날'),
      (9, 24, '추석 연휴'), (9, 25, '추석'), (9, 26, '추석 연휴'),
    ],
    2027: [
      (2, 5, '설날 연휴'), (2, 6, '설날'), (2, 7, '설날 연휴'), (2, 8, '대체공휴일'),
      (5, 13, '부처님오신날'),
      (9, 14, '추석 연휴'), (9, 15, '추석'), (9, 16, '추석 연휴'),
    ],
    2028: [
      (1, 25, '설날 연휴'), (1, 26, '설날'), (1, 27, '설날 연휴'),
      (5, 2, '부처님오신날'),
      (10, 2, '추석 연휴'), (10, 3, '추석'), (10, 4, '추석 연휴'),
    ],
    2029: [
      (2, 12, '설날 연휴'), (2, 13, '설날'), (2, 14, '설날 연휴'),
      (5, 20, '부처님오신날'),
      (9, 21, '추석 연휴'), (9, 22, '추석'), (9, 23, '추석 연휴'),
    ],
    2030: [
      (2, 2, '설날 연휴'), (2, 3, '설날'), (2, 4, '설날 연휴'),
      (5, 9, '부처님오신날'),
      (9, 11, '추석 연휴'), (9, 12, '추석'), (9, 13, '추석 연휴'),
    ],
  };

  /// 해당 날짜가 공휴일이면 이름 반환, 아니면 null
  static String? getHolidayName(DateTime date) {
    // 고정 공휴일
    final fixed = _fixedHolidays[(date.month, date.day)];
    if (fixed != null) return fixed;

    // 음력 기반 공휴일
    final lunarList = _lunarHolidays[date.year];
    if (lunarList != null) {
      for (final (m, d, name) in lunarList) {
        if (date.month == m && date.day == d) return name;
      }
    }
    return null;
  }

  /// 해당 날짜가 공휴일인지 여부
  static bool isHoliday(DateTime date) => getHolidayName(date) != null;
}
