# v1.11: Workflow Manager UI — CLI 작업 내역

## 작업 일자
2026-02-09

## 작업 범위
근로자 상세 페이지 (인사기록카드 + 월별 근태) 신규 구현 및 근로자관리 필터 바 추가

---

## 1. 근로자 상세 페이지 (신규)

### 진입 방식
- 대시보드 / 근로자관리 / 근태기록 / 급여관리 — 4개 화면에서 **근로자 이름 클릭** 시 상세 페이지 진입
- 이름 텍스트 스타일: 인디고 색상 + 밑줄 (클릭 가능 표시)

### 내비게이션 동작
- `_detailWorkerName` 상태로 오버레이 패턴 적용
- 뒤로가기 버튼 → 원래 탭 복원
- 사이드 내비 클릭 → 상세 페이지 닫히고 해당 탭 이동
- 상세 페이지 표시 시 사이드 내비 선택 해제 (selectedIndex = -1)

### 상세 페이지 레이아웃 (WorkerDetailScreen)
```
← 뒤로가기 | 근로자 상세 - {이름}
─────────────────────────────────
[인사기록카드] (Card, 읽기전용, maxWidth: 1100)
  사진 | 성명, 사번, 소속회사, 전화번호
       | 직위, 직무, 사업장, 재직상태, 입사일
─────────────────────────────────
▶ 월별 근태 현황          [2026-02 ▼]

[출근일수] [지각] [조퇴] [결근] [잔여연차] ← 요약 카드 5개

[StickyHeaderTable - 월별 근태 테이블]
 날짜(125) | 출근(80) | 퇴근(80) | 근무시간(90) | 상태(80) | 적요(180)
```

### 데모 데이터 생성 규칙
- `workerName.hashCode ^ (year*100+month)` 시드 → 일관된 랜덤 데이터
- 토/일 = 휴일 (회색 배경)
- 평일: 85% 출근, 5% 지각(09시 이후), 3% 조퇴(17시 이전), 5% 미출근, 2% 연차
- 연차 사용일: 상태 = '연차', 적요 = '연차 사용'
- 미래 날짜: 데이터 없음 표시

---

## 2. 근로자관리 필터 바 (workers_screen 수정)

### 필터 구성 (근태기록 화면과 동일 스타일)
| 필터 | 옵션 |
|------|------|
| 사업장 | 전체, 서이천, 안성, 의왕, 부평 |
| 직무 | 전체, 지게차, 지게차(야간), 피커, 피커(야간), 검수, 사무 |
| 재직상태 | 전체, 정규직, 계약직, 일용직, 파견, 육아휴직 |
| 이름 검색 | 텍스트 필드 (이름/전화번호) |
| 초기화 | 모든 필터 리셋 |

### 배치
- 인사기록카드 폼 아래, 근로자 목록 테이블 위
- Card 위젯으로 감싼 Wrap 레이아웃

---

## 3. 파일 변경 내역

### 신규 파일 (3개)
| 파일 | 내용 |
|------|------|
| `features/worker_detail/data/worker_detail_repository.dart` | WorkerMonthlyAttendanceRow, WorkerMonthlySummary 모델 + 데모 데이터 생성 |
| `features/worker_detail/providers/worker_detail_provider.dart` | detailYearMonthProvider, workerMonthlyAttendanceProvider, workerMonthlySummaryProvider |
| `features/worker_detail/presentation/worker_detail_screen.dart` | 상세 페이지 UI (인사기록카드 + 월별 근태 테이블) |

### 수정 파일 (5개)
| 파일 | 변경 사항 |
|------|----------|
| `main.dart` | _detailWorkerName 상태, _openWorkerDetail/_closeWorkerDetail, onWorkerTap 콜백 전달 |
| `dashboard_screen.dart` | onWorkerTap 파라미터 추가, 성명 컬럼(idx 2) GestureDetector |
| `workers_screen.dart` | onWorkerTap 파라미터, 성명 컬럼(idx 1) GestureDetector, 필터 바(사업장/직무/재직상태/이름/초기화) |
| `attendance_records_screen.dart` | onWorkerTap 파라미터 추가, 성명 컬럼(idx 2) GestureDetector |
| `payroll_screen.dart` | onWorkerTap 파라미터 추가, 성명 컬럼(idx 1) GestureDetector |

---

## 4. 대시보드 요약 카드 개선 (2026-02-10)

### "오늘 출근" → "주간출근" + "야간출근" 분리
- 야간 근무자(지게차(야간), 피커(야간))를 별도 집계
- `DashboardSummary`: `checkedIn` → `dayCheckedIn`(37명) + `nightCheckedIn`(8명)
- 아이콘: 주간 `Icons.wb_sunny`(초록), 야간 `Icons.nightlight_round`(보라)
- 카드 클릭 필터: 직무에 `(야간)` 포함 여부로 주간/야간 분리 필터링

---

## 5. 버튼 위치 이동

### 근태기록 탭
- "엑셀 내보내기" 버튼: 하단 우측 → **필터 바 내 "초기화" 우측으로 이동**

### 급여관리 탭
- "엑셀 내보내기" + "확정" 버튼: 우측 끝(Spacer) → **"급여대장 생성" 바로 우측으로 이동**

---

## 6. 테이블 좌측 정렬 보정
- `StickyHeaderTable.wrapWithCard`에 `Align(alignment: Alignment.topLeft)` 추가
- 컬럼 합계 너비에 맞춘 테이블 크기 유지 + 좌측 정렬 보장

---

## 7. 파일 변경 내역 (추가분)

| 파일 | 변경 사항 |
|------|----------|
| `dashboard_repository.dart` | `DashboardSummary.checkedIn` → `dayCheckedIn` + `nightCheckedIn` |
| `dashboard_screen.dart` | 주간출근/야간출근 카드 분리, 필터 로직 업데이트 |
| `attendance_records_screen.dart` | 엑셀 내보내기 버튼 필터 바 내로 이동 |
| `payroll_screen.dart` | 버튼 위치 급여대장 생성 우측으로 이동 (Spacer 제거) |
| `sticky_data_table.dart` | `Align(topLeft)` 래핑으로 좌측 정렬 |

---

## 8. 커밋 정보
- 1차 커밋: `fc65ac9` — `v1.11: 근로자 상세 페이지 + 근로자관리 필터 바`
- 2차 커밋: 대시보드 주간/야간 분리 + 버튼 위치 + 테이블 정렬

## 9. Firebase Hosting 배포
- 프로젝트: `myprojectjihun`
- `flutter build web` → `firebase.json` + `.firebaserc` 설정 → `firebase deploy --only hosting`
- **배포 URL: https://myprojectjihun.web.app**
- 누구나 브라우저에서 접속 가능 (PC/모바일)
